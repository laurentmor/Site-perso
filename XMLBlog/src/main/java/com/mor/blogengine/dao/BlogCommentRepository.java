/*  * The MIT License * * Copyright 2015 Laurent Morissette. * * Permission is hereby granted, free of charge, to any person obtaining a copy * of this software and associated documentation files (the "Software"), to deal * in the Software without restriction, including without limitation the rights * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell * copies of the Software, and to permit persons to whom the Software is * furnished to do so, subject to the following conditions: * * The above copyright notice and this permission notice shall be included in * all copies or substantial portions of the Software. * * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN * THE SOFTWARE. *//*  * The MIT License * * Copyright 2015 laurent. * * Permission is hereby granted, free of charge, to any person obtaining a copy * of this software and associated documentation files (the "Software"), to deal * in the Software without restriction, including without limitation the rights * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell * copies of the Software, and to permit persons to whom the Software is * furnished to do so, subject to the following conditions: * * The above copyright notice and this permission notice shall be included in * all copies or substantial portions of the Software. * * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN * THE SOFTWARE. */package com.mor.blogengine.dao;//~--- non-JDK imports --------------------------------------------------------import com.mor.blogengine.exception.ElementExistingException;import com.mor.blogengine.exception.IncorrectPropertyValueException;import com.mor.blogengine.exception.MissingPropertyException;import com.mor.blogengine.exception.NoMatchesFoundException;import com.mor.blogengine.model.BlogComment;import com.mor.blogengine.xpath.SearchCriteria;import com.mor.blogengine.xpath.SearchEngine;import org.dom4j.DocumentException;import org.dom4j.tree.DefaultElement;//~--- JDK imports ------------------------------------------------------------import java.util.List;import java.util.Properties;import java.util.logging.Level;import java.util.logging.Logger;import org.dom4j.Document;/** * * @author laurent */public class BlogCommentRepository extends BlogRepositoryBase        implements IRepository<BlogComment, DefaultElement, SearchCriteria, DocumentException> {    /**     * Default constructor     *     * @param document document instance that holds blog data     * @param config global configuration file for application     */    public BlogCommentRepository(final Properties config, final Document document) {        super(document, config);    }    /**     * add a comment to blog     *     * @param t the comment to add     * @return true if comment added correctly     * @throws ElementExistingException if element to add exist     * @deprecated use {@link #append(BlogComment what, String parentID)}     */    @Override    public boolean add(BlogComment t) throws ElementExistingException {        return false;    }    /**     * append a comment to a parernt entry to a blog     *     * @param what the comment to append     * @param parentID the Id of parent entry to append to     * @return true if Category appended correctly     * @throws NoMatchesFoundException     *     */    @Override    public boolean append(BlogComment what, String parentID) throws NoMatchesFoundException {        try {            trace("Appending element... " + what.getCommentText());        }        catch (MissingPropertyException | IncorrectPropertyValueException ex) {            Logger.getLogger(BlogCommentRepository.class.getName()).log(Level.SEVERE, null, ex);        }        List<DefaultElement> foundList =  searchEngine.getElementsForCriteria("Entry",                SearchCriteria.SINGLE, parentID);        try {            DefaultElement relatedEntry = foundList.get(0);            boolean appended = handler.append(relatedEntry, what.toElement());            return appended;        }        catch (Exception ex) {            try {                trace(ex.getMessage());            }            catch (MissingPropertyException | IncorrectPropertyValueException ex1) {                Logger.getLogger(BlogCommentRepository.class.getName()).log(Level.SEVERE, null, ex1);            }        }        throw new NoMatchesFoundException();    }    /**     * remove a comment to blog     *     * @param t the comment to remove     * @return true if Comment removed correctly     *     * @throws NoMatchesFoundException     * @throws DocumentException if there is an issue with XML structure     */    @Override    public boolean remove(BlogComment t) throws NoMatchesFoundException, DocumentException {        List<DefaultElement> list = getElementsForCriteria(SearchCriteria.SINGLE, t.getEntityID());        return handler.remove(list.get(0), t.getEntryID());    }    /**     * edit a comment in a blog     *     * @param t the comment to edit     * @param t2 the new comment     * @return true if Comment edited correctly     * @throws NoMatchesFoundException     * @throws DocumentException if there is an issue with XML structure     */    @Override    public boolean edit(BlogComment t, BlogComment t2) throws NoMatchesFoundException, DocumentException {        boolean removed = remove(t);        boolean appended = append(t2, t2.getEntryID());        return removed && appended;    }    /**     * Enable the search for comment and criteria in XML <br/>     *     * @param searchParam what to search<br/>     * @param paramValue search for what criteria<br/>     *     * @return list of results<br/>     * @throws NoMatchesFoundException     */    @Override    public List<DefaultElement> getElementsForCriteria(SearchCriteria searchParam, String paramValue)            throws NoMatchesFoundException {        List<DefaultElement> list = searchEngine.getElementsForCriteria("Comment",                searchParam, paramValue);        if (list == null) {            throw new NoMatchesFoundException();        }        return list;    }    @Override    public boolean append(BlogComment what)            throws NoMatchesFoundException, ElementExistingException, DocumentException {        throw new UnsupportedOperationException("Not supported yet.");    }}//~ Formatted by Jindent --- http://www.jindent.com